#include "PotReader.h"
#include "MCP3008.h"
#include <thread>
//#include <unistd.h>      // only works on the PI itself (UNIX)

// Maps potentiometer readings [0-1023] to the corresponding logarithmic values [0.0-1.0]
float lin2log[1024] = {
0.0f,0.000393622825808293f,0.0007878654073326108f,0.0011827287203728942f,0.0015782137422654663f,0.001974321451885641f,0.0023710528296497224f,0.0027684088575178345f,0.0031663905189960873f,0.003564998799139185f,0.003964234684552759f,0.004364099163395863f,0.004764593225383362f,0.005165717861788488f,0.005567474065445166f,0.005969862830750461f,0.006372885153667296f,0.006776542031726562f,0.007180834464029784f,0.00758576345125167f,0.007991329995642338f,0.008397535101030085f,0.008804379772823556f,0.00921186501801452f,0.009619991845180254f,0.010028761264485986f,0.010438174287687396f,0.010848231928133334f,0.011258935200767928f,0.011670285122133472f,0.012082282710372871f,0.012494928985231857f,0.012908224968061932f,0.013322171681822592f,0.013736770151084099f,0.014152021402029813f,0.014567926462458802f,0.014984486361788396f,0.015401702131056738f,0.015819574802925396f,0.016238105411681747f,0.0166572949932417f,0.01707714458515225f,0.017497655226593967f,0.01791882795838351f,0.018340663822976444f,0.018763163864469523f,0.019186329128603574f,0.01961016066276583f,0.020034659515992703f,0.020459826738972176f,0.020885663384046627f,0.02131217050521539f,0.021739349158137133f,0.022167200400132925f,0.022595725290188218f,0.02302492488895619f,0.023454800258759734f,0.023885352463594578f,0.02431658256913144f,0.024748491642719195f,0.025181080753387097f,0.02561435097184761f,0.02604830337049907f,0.026482939023428187f,0.02691825900641298f,0.027354264396925065f,0.02779095627413264f,0.028228335718903097f,0.028666403813805585f,0.029105161643113664f,0.02954461029280825f,0.02998475085058f,0.030425584405832207f,0.030867112049683232f,0.03130933487496973f,0.031752253976248646f,0.032195870449800656f,0.03264018539363217f,0.03308519990747866f,0.033530915092807034f,0.03397733205281839f,0.03442445189245097f,0.03487227571838247f,0.03532080463903331f,0.035770039764568995f,0.03621998220690292f,0.036670633079699255f,0.03712199349837558f,0.03757406458010576f,0.038026847443822565f,0.03848034321022059f,0.0389345530017588f,0.03938947794266362f,0.039845119158931575f,0.04030147777833193f,0.04075855493040964f,0.041216351746488245f,0.04167486935967235f,0.042134108904850864f,0.04259407151869932f,0.04305475833968314f,0.04351617050806006f,0.043978309165883356f,0.04444117545700421f,0.04490477052707503f,0.045369095523551894f,0.04583415159569759f,0.04629993989458442f,0.04676646157309694f,0.0472337177859351f,0.047701709689616734f,0.0481704384424807f,0.04863990520468964f,0.04911011113823277f,0.04958105740692903f,0.05005274517642966f,0.05052517561422121f,0.050998349889628425f,0.0514722691738172f,0.05194693463979738f,0.05242234746242569f,0.05289850881840863f,0.05337541988630551f,0.05385308184653126f,0.054331495881359215f,0.05481066317492439f,0.055290584913226026f,0.055771262284130874f,0.05625269647737591f,0.05673488868457127f,0.05721784009920333f,0.05770155191663762f,0.058186025334121705f,0.058671261550788334f,0.059157261767658065f,0.05964402718764261f,0.060131559015547675f,0.060619858458075826f,0.061108926723829615f,0.06159876502331446f,0.062089374568941924f,0.0625807565750322f,0.06307291225781764f,0.06356584283544547f,0.06405954952798087f,0.06455403355741002f,0.0650492961476431f,0.06554533852451733f,0.06604216191579992f,0.0665397675511914f,0.06703815666232821f,0.06753733048278615f,0.0680372902480832f,0.06853803719568263f,0.06903957256499621f,0.06954189759738705f,0.07004501353617276f,0.07054892162662862f,0.07105362311599056f,0.0715591192534582f,0.07206541129019811f,0.07257250047934677f,0.07308038807601369f,0.07358907533728459f,0.07409856352222438f,0.07460885389188054f,0.07511994770928582f,0.07563184623946173f,0.0761445507494215f,0.07665806250817336f,0.0771723827867235f,0.07768751285807929f,0.07820345399725248f,0.07872020748126224f,0.0792377745891385f,0.07975615660192498f,0.08027535480268233f,0.08079537047649143f,0.08131620491045644f,0.08183785939370819f,0.08236033521740715f,0.0828836336747466f,0.08340775606095618f,0.08393270367330463f,0.08445847781110344f,0.08498507977570963f,0.08551251087052936f,0.08604077240102098f,0.08656986567469815f,0.08709979200113332f,0.08763055269196085f,0.08816214906088016f,0.08869458242365919f,0.08922785409813744f,0.08976196540422943f,0.09029691766392778f,0.09083271220130673f,0.09136935034252508f,0.09190683341582973f,0.09244516275155895f,0.09298433968214559f,0.09352436554212029f,0.09406524166811508f,0.09460696939886637f,0.09514955007521847f,0.09569298504012674f,0.09623727563866113f,0.0967824232180094f,0.0973284291274803f,0.09787529471850714f,0.09842302134465114f,0.09897161036160457f,0.09952106312719416f,0.1000713810013848f,0.10062256534628228f,0.10117461752613732f,0.10172753890734848f,0.10228133085846575f,0.10283599475019384f,0.10339153195539563f,0.10394794384909567f,0.10450523180848337f,0.10506339721291647f,0.10562244144392469f,0.10618236588521268f,0.10674317192266397f,0.10730486094434405f,0.10786743434050389f,0.10843089350358337f,0.10899523982821491f,0.10956047471122654f,0.11012659955164578f,0.1106936157507028f,0.11126152471183404f,0.11183032784068558f,0.11240002654511677f,0.11297062223520354f,0.11354211632324201f,0.11411451022375196f,0.11468780535348028f,0.11526200313140456f,0.1158371049787365f,0.11641311231892554f,0.11699002657766228f,0.11756784918288216f,0.11814658156476876f,0.11872622515575748f,0.11930678139053924f,0.11988825170606371f,0.12047063754154302f,0.12105394033845546f,0.1216381615405488f,0.12222330259384395f,0.12280936494663869f,0.1233963500495111f,0.12398425935532309f,0.12457309431922414f,0.12516285639865493f,0.12575354705335073f,0.12634516774534527f,0.12693771993897418f,0.12753120510087862f,0.12812562470000916f,0.1287209802076289f,0.12931727309731778f,0.1299145048449757f,0.13051267692882623f,0.13111179082942065f,0.1317118480296412f,0.13231285001470494f,0.1329147982721674f,0.13351769429192628f,0.13412153956622497f,0.13472633558965652f,0.13533208385916723f,0.13593878587406022f,0.13654644313599928f,0.13715505714901266f,0.13776462941949658f,0.13837516145621898f,0.13898665477032363f,0.13959911087533328f,0.14021253128715389f,0.1408269175240781f,0.14144227110678925f,0.14205859355836475f,0.1426758864042802f,0.14329415117241318f,0.14391338939304665f,0.1445336025988731f,0.14515479232499834f,0.14577696010894498f,0.14640010749065657f,0.1470242360125013f,0.1476493472192758f,0.1482754426582089f,0.14890252387896563f,0.14953059243365086f,0.15015964987681324f,0.15078969776544915f,0.15142073765900632f,0.15205277111938786f,0.1526857997109562f,0.1533198250005366f,0.15395484855742148f,0.154590871953374f,0.15522789676263216f,0.1558659245619124f,0.15650495693041383f,0.15714499544982197f,0.15778604170431265f,0.158428097280556f,0.1590711637677203f,0.15971524275747606f,0.16036033584399983f,0.16100644462397806f,0.1616535706966113f,0.162301715663618f,0.16295088112923856f,0.163601068700239f,0.16425227998591552f,0.16490451659809785f,0.16555778015115374f,0.16621207226199264f,0.16686739455006983f,0.1675237486373904f,0.16818113614851332f,0.16883955871055534f,0.1694990179531951f,0.1701595155086773f,0.17082105301181638f,0.17148363210000095f,0.17214725441319756f,0.17281192159395492f,0.17347763528740795f,0.17414439714128171f,0.17481220880589576f,0.17548107193416795f,0.17615098818161862f,0.17682195920637483f,0.1774939866691742f,0.17816707223336936f,0.1788412175649316f,0.17951642433245557f,0.18019269420716283f,0.18087002886290648f,0.18154842997617499f,0.1822278992260964f,0.18290843829444264f,0.18359004886563351f,0.18427273262674093f,0.18495649126749308f,0.1856413264802786f,0.18632723996015077f,0.1870142334048318f,0.1877023085147168f,0.18839146699287834f,0.18908171054507028f,0.1897730408797323f,0.19046545970799383f,0.19115896874367871f,0.19185356970330897f,0.19254926430610936f,0.1932460542740116f,0.1939439413316585f,0.19464292720640824f,0.1953430136283389f,0.19604420233025238f,0.19674649504767894f,0.19744989351888148f,0.19815439948485958f,0.19886001468935416f,0.19956674087885168f,0.20027457980258834f,0.20098353321255452f,0.20169360286349908f,0.20240479051293375f,0.2031170979211374f,0.2038305268511605f,0.2045450790688294f,0.2052607563427507f,0.20597756044431575f,0.20669549314770486f,0.2074145562298917f,0.20813475147064797f,0.2088560806525474f,0.2095785455609705f,0.21030214798410884f,0.2110268897129694f,0.21175277254137914f,0.21247979826598934f,0.21320796868628022f,0.2139372856045651f,0.2146677508259951f,0.21539936615856353f,0.21613213341311044f,0.21686605440332696f,0.21760113094575978f,0.21833736485981592f,0.21907475796776688f,0.21981331209475335f,0.2205530290687897f,0.2212939107207686f,0.2220359588844652f,0.22277917539654213f,0.22352356209655377f,0.22426912082695077f,0.2250158534330849f,0.22576376176321322f,0.22651284766850288f,0.22726311300303587f,0.22801455962381312f,0.22876718939075968f,0.22952100416672888f,0.230276005817507f,0.2310321962118183f,0.23178957722132898f,0.23254815072065238f,0.23330791858735334f,0.23406888270195286f,0.23483104494793294f,0.2355944072117409f,0.2363589713827945f,0.23712473935348616f,0.237891713019188f,0.23865989427825623f,0.2394292850320362f,0.2401998871848668f,0.2409717026440853f,0.241744733320032f,0.24251898112605513f,0.2432944479785154f,0.2440711357967908f,0.24484904650328138f,0.24562818202341408f,0.24640854428564724f,0.24719013522147565f,0.24797295676543518f,0.2487570108551077f,0.24954229943112566f,0.2503288244371771f,0.25111658782001034f,0.2519055915294388f,0.252695837518346f,0.2534873277426902f,0.2542800641615093f,0.2550740487369254f,0.2558692834341505f,0.2566657702214904f,0.25746351107035004f,0.25826250795523853f,0.2590627628537736f,0.25986427774668674f,0.26066705461782813f,0.2614710954541717f,0.2622764022458194f,0.263082976986007f,0.26389082167110856f,0.2646999383006411f,0.2655103288772701f,0.2663219954068142f,0.2671349398982503f,0.2679491643637182f,0.26876467081852573f,0.2695814612811541f,0.27039953777326253f,0.27121890231969314f,0.27203955694847626f,0.2728615036908353f,0.27368474458119196f,0.27450928165717103f,0.27533511695960533f,0.27616225253254123f,0.2769906904232433f,0.2778204326821996f,0.27865148136312645f,0.2794838385229741f,0.2803175062219311f,0.28115248652342983f,0.28198878149415174f,0.2828263932040319f,0.28366532372626474f,0.2845055751373089f,0.2853471495168922f,0.28619004894801725f,0.28703427551696614f,0.28787983131330575f,0.28872671842989306f,0.28957493896288033f,0.29042449501171996f,0.29127538867917013f,0.2921276220712997f,0.2929811972974934f,0.2938361164704575f,0.29469238170622436f,0.29554999512415825f,0.29640895884696006f,0.29726927500067335f,0.2981309457146887f,0.29899397312174947f,0.2998583593579571f,0.30072410656277626f,0.3015912168790402f,0.3024596924529561f,0.30332953543411023f,0.30420074797547325f,0.30507333223340605f,0.3059472903676642f,0.3068226245414042f,0.3076993369211881f,0.3085774296769894f,0.30945690498219824f,0.3103377650136264f,0.3112200119515136f,0.3121036479795317f,0.31298867528479113f,0.3138750960578458f,0.3147629124926987f,0.3156521267868071f,0.31654274114108827f,0.3174347577599248f,0.31832817885117004f,0.31922300662615366f,0.3201192432996868f,0.32101689109006804f,0.32191595221908864f,0.3228164289120379f,0.323718323397709f,0.32462163790840426f,0.3255263746799407f,0.32643253595165556f,0.3273401239664121f,0.32824914097060487f,0.3291595892141651f,0.330071470950567f,0.3309847884368323f,0.33189954393353693f,0.3328157397048156f,0.33373337801836833f,0.3346524611454652f,0.33557299136095264f,0.33649497094325864f,0.3374184021743989f,0.33834328733998165f,0.33926962872921407f,0.34019742863490765f,0.3411266893534839f,0.34205741318498006f,0.34298960243305454f,0.34392325940499313f,0.3448583864117142f,0.3457949857677748f,0.34673305979137614f,0.3476726108043694f,0.34861364113226156f,0.34955615310422106f,0.3505001490530837f,0.351445631315358f,0.3523926022312316f,0.35334106414457667f,0.3542910194029558f,0.3552424703576277f,0.35619541936355315f,0.3571498687794009f,0.3581058209675533f,0.3590632782941122f,0.36002224312890496f,0.3609827178454903f,0.3619447048211638f,0.3629082064369643f,0.3638732250776796f,0.36483976313185207f,0.36580782299178516f,0.3667774070535488f,0.36774851771698525f,0.368721157385716f,0.36969532846714626f,0.370671033372472f,0.3716482745166857f,0.3726270543185821f,0.3736073752007645f,0.3745892395896502f,0.3755726499154771f,0.3765576086123096f,0.37754411811804434f,0.3785321808744163f,0.37952179932700525f,0.38051297592524136f,0.3815057131224113f,0.38250001337566475f,0.38349587914601957f,0.3844933128983691f,0.38549231710148724f,0.386492894228035f,0.3874950467545668f,0.38849877716153614f,0.38950408793330205f,0.390510981558135f,0.39151946052822373f,0.3925295273396803f,0.39354118449254716f,0.3945544344908031f,0.3955692798423692f,0.39658572305911555f,0.3976037666568669f,0.3986234131554093f,0.39964466507849583f,0.4006675249538538f,0.40169199531319f,0.4027180786921972f,0.4037457776305612f,0.40477509467196604f,0.40580603236410073f,0.4068385932586659f,0.4078727799113796f,0.40890859488198394f,0.4099460407342512f,0.4109851200359905f,0.4120258353590537f,0.4130681892793423f,0.4141121843768132f,0.41515782323548567f,0.4162051084434475f,0.41725404259286125f,0.41830462827997095f,0.4193568681051082f,0.4204107646726991f,0.4214663205912702f,0.42252353847345525f,0.4235824209360013f,0.42464297059977585f,0.4257051900897726f,0.42676908203511843f,0.42783464906907986f,0.4289018938290693f,0.4299708189566517f,0.43104142709755133f,0.432113720901658f,0.43318770302303367f,0.4342633761199194f,0.4353407428547411f,0.43641980589411733f,0.4375005679088646f,0.438583031574005f,0.4396671995687723f,0.4407530745766185f,0.441840659285221f,0.4429299563864887f,0.44402096857656903f,0.44511369855585436f,0.44620814902898875f,0.4473043227048751f,0.4484022222966808f,0.44950185052184566f,0.4506032101020878f,0.4517063037634109f,0.4528111342361103f,0.4539177042547805f,0.45502601655832153f,0.4561360738899458f,0.4572478789971848f,0.45836143463189594f,0.4594767435502697f,0.4605938085128358f,0.4617126322844707f,0.46283321763440377f,0.4639555673362249f,0.4650796841678907f,0.46620557091173187f,0.4673332303544595f,0.46846266528717284f,0.46959387850536527f,0.4707268728089318f,0.4718616510021759f,0.4729982158938164f,0.4741365702969944f,0.4752767170292801f,0.4764186589126802f,0.4775623987736446f,0.4787079394430732f,0.47985528375632336f,0.4810044345532165f,0.48215539467804547f,0.48330816697958134f,0.48446275431108055f,0.485619159530292f,0.48677738549946425f,0.48793743508535203f,0.4890993111592241f,0.49026301659687f,0.491428554278607f,0.49259592708928746f,0.4937651379183059f,0.4949361896596063f,0.49610908521168906f,0.4972838274776181f,0.4984604193650285f,0.4996388637861331f,0.5008191636577299f,0.5020013219012098f,0.5031853414425632f,0.5043712252123873f,0.5055589761458935f,0.5067485971829152f,0.5079400912679136f,0.5091334613499867f,0.5103287103828756f,0.511525841324972f,0.5127248571393256f,0.5139257607936512f,0.5151285552603366f,0.5163332435164494f,0.5175398285437446f,0.5187483133286718f,0.519958700862383f,0.5211709941407395f,0.5223851961643199f,0.5236013099384267f,0.5248193384730946f,0.5260392847830974f,0.5272611518879556f,0.5284849428119444f,0.5297106605840998f,0.5309383082382276f,0.5321678888129103f,0.5333994053515145f,0.5346328609021986f,0.5358682585179201f,0.5371056012564436f,0.5383448921803481f,0.5395861343570343f,0.540829330858733f,0.5420744847625119f,0.5433215991502833f,0.5445706771088126f,0.5458217217297245f,0.5470747361095121f,0.5483297233495433f,0.5495866865560698f,0.5508456288402334f,0.5521065533180747f,0.5533694631105404f,0.5546343613434911f,0.5559012511477089f,0.5571701356589058f,0.5584410180177304f,0.5597139013697763f,0.56098878886559f,0.5622656836606785f,0.5635445889155171f,0.564825507795557f,0.5661084434712337f,0.5673933991179744f,0.5686803779162058f,0.5699693830513626f,0.5712604177138945f,0.5725534850992746f,0.5738485884080077f,0.575145730845637f,0.5764449156227535f,0.5777461459550028f,0.5790494250630938f,0.5803547561728062f,0.5816621425149986f,0.5829715873256167f,0.5842830938457013f,0.5855966653213959f,0.5869123050039551f,0.5882300161497527f,0.5895498020202895f,0.5908716658822016f,0.5921956110072684f,0.5935216406724205f,0.5948497581597482f,0.5961799667565094f,0.5975122697551377f,0.5988466704532507f,0.6001831721536578f,0.6015217781643689f,0.6028624917986024f,0.6042053163747931f,0.6055502552166008f,0.6068973116529183f,0.6082464890178797f,0.6095977906508688f,0.6109512198965271f,0.6123067801047622f,0.6136644746307562f,0.6150243068349738f,0.6163862800831709f,0.6177503977464024f,0.6191166632010312f,0.6204850798287364f,0.621855651016521f,0.6232283801567212f,0.6246032706470144f,0.6259803258904274f,0.6273595492953453f,0.6287409442755195f,0.6301245142500762f,0.6315102626435253f,0.6328981928857684f,0.6342883084121074f,0.635680612663253f,0.6370751090853336f,0.6384718011299031f,0.6398706922539501f,0.6412717859199061f,0.6426750855956541f,0.6440805947545374f,0.645488316875368f,0.6468982554424352f,0.6483104139455144f,0.6497247958798754f,0.6511414047462916f,0.652560244051048f,0.6539813173059504f,0.6554046280283339f,0.6568301797410716f,0.6582579759725834f,0.6596880202568445f,0.6611203161333943f,0.6625548671473453f,0.6639916768493921f,0.665430748795819f,0.6668720865485103f,0.6683156936749581f,0.6697615737482719f,0.6712097303471867f,0.6726601670560722f,0.6741128874649417f,0.6755678951694611f,0.6770251937709573f,0.6784847868764278f,0.679946678098549f,0.6814108710556859f,0.6828773693718999f,0.6843461766769591f,0.6858172966063462f,0.6872907328012681f,0.6887664889086648f,0.6902445685812182f,0.6917249754773616f,0.6932077132612882f,0.6946927856029605f,0.6961801961781197f,0.6976699486682936f,0.6991620467608073f,0.7006564941487912f,0.7021532945311907f,0.7036524516127749f,0.7051539691041462f,0.7066578507217494f,0.7081641001878806f,0.7096727212306967f,0.7111837175842246f,0.7126970929883703f,0.7142128511889284f,0.715730995937591f,0.7172515309919576f,0.7187744601155434f,0.7202997870777897f,0.7218275156540728f,0.7233576496257129f,0.7248901927799841f,0.7264251489101236f,0.7279625218153407f,0.729502315300827f,0.731044533177765f,0.7325891792633379f,0.7341362573807391f,0.7356857713591815f,0.7372377250339073f,0.7387921222461968f,0.740348966843379f,0.7419082626788399f,0.7434700136120329f,0.745034223508488f,0.7466008962398216f,0.7481700356837456f,0.7497416457240776f,0.7513157302507503f,0.7528922931598208f,0.7544713383534805f,0.756052869740065f,0.7576368912340636f,0.7592234067561285f,0.7608124202330855f,0.7624039355979426f,0.7639979567899007f,0.7655944877543626f,0.7671935324429435f,0.7687950948134801f,0.7703991788300404f,0.7720057884629348f,0.7736149276887236f,0.7752266004902291f,0.7768408108565443f,0.778457562783043f,0.7800768602713892f,0.7816987073295485f,0.7833231079717957f,0.7849500662187272f,0.7865795860972693f,0.7882116716406884f,0.789846326888602f,0.791483555886987f,0.7931233626881915f,0.7947657513509434f,0.7964107259403614f,0.7980582905279645f,0.7997084491916824f,0.801361206015865f,0.8030165650912937f,0.8046745305151906f,0.8063351063912283f,0.8079982968295412f,0.8096641059467349f,0.8113325378658964f,0.8130035967166047f,0.8146772866349405f,0.8163536117634973f,0.8180325762513903f,0.8197141842542679f,0.8213984399343215f,0.8230853474602957f,0.8247749110074989f,0.8264671347578134f,0.828162022899706f,0.829859579628238f,0.8315598091450755f,0.8332627156585011f,0.8349683033834223f,0.836676576541383f,0.8383875393605749f,0.8401011960758453f,0.8418175509287109f,0.8435366081673656f,0.8452583720466922f,0.8469828468282732f,0.8487100367804004f,0.850439946178086f,0.8521725793030739f,0.8539079404438488f,0.8556460338956478f,0.8573868639604707f,0.8591304349470912f,0.8608767511710667f,0.8626258169547494f,0.8643776366272975f,0.8661322145246848f,0.8678895549897123f,0.8696496623720189f,0.8714125410280915f,0.8731781953212769f,0.8749466296217914f,0.8767178483067326f,0.8784918557600891f,0.8802686563727529f,0.882048254542529f,0.8838306546741466f,0.8856158611792704f,0.8874038784765108f,0.8891947109914358f,0.8909883631565811f,0.8927848394114615f,0.8945841442025815f,0.8963862819834472f,0.8981912572145758f,0.8999990743635087f,0.9018097379048202f,0.9036232523201309f,0.9054396220981165f,0.907258851734521f,0.9090809457321667f,0.9109059086009652f,0.9127337448579296f,0.9145644590271842f,0.9163980556399769f,0.9182345392346902f,0.9200739143568519f,0.9219161855591469f,0.9237613574014278f,0.9256094344507277f,0.9274604212812694f,0.929314322474478f,0.9311711426189924f,0.933030886310676f,0.9348935581526285f,0.936759162755197f,0.9386277047359872f,0.9404991887198761f,0.9423736193390218f,0.9442510012328758f,0.9461313390481945f,0.9480146374390506f,0.9499009010668444f,0.9517901346003159f,0.9536823427155556f,0.9555775300960165f,0.9574757014325261f,0.9593768614232971f,0.9612810147739397f,0.9631881661974726f,0.965098320414336f,0.9670114821524016f,0.9689276561469857f,0.9708468471408596f,0.9727690598842624f,0.974694299134913f,0.9766225696580202f,0.9785538762262962f,0.9804882236199681f,0.9824256166267886f,0.9843660600420494f,0.9863095586685917f,0.9882561173168196f,0.9902057408047102f,0.9921584339578271f,0.9941142016093316f,0.9960730485999945f,0.9980349797782084f,1.0f};

void PotReader::start()
{
	killThread = false;
	updater = new std::thread(updateValues, potValues, &killThread);
}

void PotReader::stop()
{
	killThread = true;
	updater->join();
}

int PotReader::read(int mcp, int pot)
{
	return potValues[getIndex(mcp, pot)];
}

float PotReader::readNormalized(int mcp, int pot)
{
	return ((float)potValues[getIndex(mcp, pot)]) / 1024.0f;
}

float PotReader::readLogarithmic(int mcp, int pot)
{
	return lin2log[potValues[getIndex(mcp, pot)]];
}

void updateValues(int *vals, bool* killSignal)
{
	JUCE_GPIO::MCP3008 mcp;

	while (!(*killSignal))
	{
		vals[getIndex(0, 0)] = mcp.mcp3008_value(0, 11, 9, 10, 8);
		vals[getIndex(0, 1)] = mcp.mcp3008_value(1, 11, 9, 10, 8);
		vals[getIndex(0, 2)] = mcp.mcp3008_value(2, 11, 9, 10, 8);
		vals[getIndex(0, 3)] = mcp.mcp3008_value(3, 11, 9, 10, 8);
		//vals[getIndex(0,4)] = mcp.mcp3008_value(4, 11, 9, 10, 8); NO POT PLUGGED IN
		//vals[getIndex(0,5)] = mcp.mcp3008_value(5, 11, 9, 10, 8); NO POT PLUGGED IN
		//vals[getIndex(0,6)] = mcp.mcp3008_value(6, 11, 9, 10, 8); NO POT PLUGGED IN
		//vals[getIndex(0,7)] = mcp.mcp3008_value(7, 11, 9, 10, 8); NO POT PLUGGED IN

		vals[getIndex(1, 0)] = mcp.mcp3008_value(0, 11, 9, 10, 23);
		vals[getIndex(1, 1)] = mcp.mcp3008_value(1, 11, 9, 10, 23);
		vals[getIndex(1, 2)] = mcp.mcp3008_value(2, 11, 9, 10, 23);
		vals[getIndex(1, 3)] = mcp.mcp3008_value(3, 11, 9, 10, 23);
		vals[getIndex(1, 4)] = mcp.mcp3008_value(4, 11, 9, 10, 23);
		vals[getIndex(1, 5)] = mcp.mcp3008_value(5, 11, 9, 10, 23);
		vals[getIndex(1, 6)] = mcp.mcp3008_value(6, 11, 9, 10, 23);
		vals[getIndex(1, 7)] = mcp.mcp3008_value(7, 11, 9, 10, 23);

		vals[getIndex(1, 0)] = mcp.mcp3008_value(0, 11, 9, 10, 25);
		vals[getIndex(1, 1)] = mcp.mcp3008_value(1, 11, 9, 10, 25);
		vals[getIndex(1, 2)] = mcp.mcp3008_value(2, 11, 9, 10, 25);
		vals[getIndex(1, 3)] = mcp.mcp3008_value(3, 11, 9, 10, 25);
		vals[getIndex(1, 4)] = mcp.mcp3008_value(4, 11, 9, 10, 25);
		vals[getIndex(1, 5)] = mcp.mcp3008_value(5, 11, 9, 10, 25);
		vals[getIndex(1, 6)] = mcp.mcp3008_value(6, 11, 9, 10, 25);
		vals[getIndex(1, 7)] = mcp.mcp3008_value(7, 11, 9, 10, 25);

		//vals[getIndex(1, 0)] = mcp.mcp3008_value(0, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 1)] = mcp.mcp3008_value(1, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 2)] = mcp.mcp3008_value(2, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 3)] = mcp.mcp3008_value(3, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 4)] = mcp.mcp3008_value(4, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 5)] = mcp.mcp3008_value(5, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 6)] = mcp.mcp3008_value(6, 11, 9, 10, 4th PIN HERE);
		//vals[getIndex(1, 7)] = mcp.mcp3008_value(7, 11, 9, 10, 4th PIN HERE);

		//usleep(11609);     //ONLY WORKS ON PI (UNIX)
	}
}

int getIndex(int mcp, int pot)
{
	return (mcp * 8) + pot;
}